/* =========================================================
   CRISPR Genetics Lab - Post-Apocalyptic UI Theme
   ========================================================= */

/* ---------- Design Tokens ---------- */
:root{
  /* Palette – Asche, Stahl, Rost, Neon-Toxin */
  --bg:          #0b0f12;
  --bg-2:        #0f1419;
  --panel:       #141a20;
  --panel-top:   #16202a;
  --ink:         #d1e7ff;
  --ink-dim:     #a9bed1;
  --muted:       #8aa0b3;
  --grid:        #1a222a;
  --vignette:    rgba(0,0,0,.35);

  --accent:      #2ee56a; /* Matrix-Grün für Food / Highlights */
  --brand:       #27c7ff; /* kaltes Neon-Blau */
  --rust:        #c26f3a; /* Rost-Orange */
  --warn:        #ff6b6b; /* Alarmrot */

  --line-1:      #22303a;
  --line-2:      #2a3a46;

  --topbar-h:    56px;     /* wird per JS dynamisch gesetzt */
  --radius:      12px;
  --shadow-1:    0 12px 32px rgba(0,0,0,.45);
  --shadow-2:    0 18px 48px rgba(0,0,0,.55);
}

/* ---------- Base Reset ---------- */
*{ box-sizing: border-box; }
html,body{
  margin:0; height:100%;
  color:var(--ink);
  background:
    radial-gradient(1200px 600px at 50% -10%, rgba(255,255,255,.04), transparent 60%),
    radial-gradient(900px 500px at -10% 20%, rgba(255,255,255,.03), transparent 55%),
    radial-gradient(900px 500px at 110% 30%, rgba(255,255,255,.035), transparent 55%),
    linear-gradient(180deg, #0c1116, #090d10 60%, #070a0d);
  font:14px/1.45 system-ui, Segoe UI, Roboto, Helvetica, Arial;
}

/* Subtle noise overlay (no image) */
body::before{
  content:"";
  position:fixed; inset:0; z-index:-1;
  background:
    radial-gradient(40% 60% at 50% 20%, rgba(255,255,255,.03), transparent 60%),
    repeating-linear-gradient(90deg, rgba(255,255,255,.015), rgba(255,255,255,.015) 1px, transparent 1px, transparent 3px),
    repeating-linear-gradient(0deg, rgba(255,255,255,.012), rgba(255,255,255,.012) 1px, transparent 1px, transparent 3px);
  mix-blend-mode: screen;
  pointer-events:none;
}

/* ---------- Controls: Buttons, Inputs ---------- */
button{
  appearance:none;
  background:#15222c;
  border:1px solid var(--line-2);
  color:#d8f0ff;
  border-radius:8px;
  padding:6px 10px;
  cursor:pointer;
  transition:transform .06s ease, background .12s ease, box-shadow .12s ease;
}
button:hover{ background:#1a2a35; box-shadow:0 0 0 1px rgba(39,199,255,.15) inset; }
button:active{ transform:translateY(1px); }

input[type="range"]{
  -webkit-appearance:none; appearance:none;
  width:140px; height:18px; background:transparent; cursor:pointer;
}
input[type="range"]::-webkit-slider-runnable-track{
  height:4px; border-radius:999px;
  background:linear-gradient(90deg, #21303a, #233240);
  box-shadow:inset 0 0 0 1px #2a3a46, 0 1px 0 rgba(0,0,0,.4);
}
input[type="range"]::-moz-range-track{
  height:4px; border-radius:999px;
  background:linear-gradient(90deg, #21303a, #233240);
  box-shadow:inset 0 0 0 1px #2a3a46, 0 1px 0 rgba(0,0,0,.4);
}
input[type="range"]::-webkit-slider-thumb{
  -webkit-appearance:none; appearance:none;
  width:14px; height:14px; border-radius:50%;
  background: radial-gradient(circle at 30% 30%, #fff, #9bdcff 60%, #1a86ff);
  border:1px solid #2b7bbf;
  margin-top:-5px;
  box-shadow:0 0 0 2px rgba(39,199,255,.15);
}
input[type="range"]::-moz-range-thumb{
  width:14px; height:14px; border-radius:50%;
  background: radial-gradient(circle at 30% 30%, #fff, #9bdcff 60%, #1a86ff);
  border:1px solid #2b7bbf;
  box-shadow:0 0 0 2px rgba(39,199,255,.15);
}

/* Text Inputs (Search etc.) */
input[type="text"]{
  background:#0d1419;
  border:1px solid var(--line-2);
  color:var(--ink);
  border-radius:8px;
  padding:8px 10px;
}
input[type="text"]::placeholder{ color:#6f8598; }

/* Badges */
.badge{
  display:inline-block;
  padding:2px 6px;
  border-radius:999px;
  background:#18242d;
  border:1px solid #274050;
  color:#bde1ff;
  font-size:12px;
}

/* Simple rows */
.row{ display:flex; align-items:center; justify-content:space-between; gap:8px; margin:8px 0; }
.row > span:first-child{ color:var(--muted); }

/* ---------- Topbar ---------- */
#topbar{
  position:fixed; top:0; left:0; right:0; z-index:1000;
  display:flex; align-items:center; justify-content:space-between;
  padding:8px 10px;
  background:
    linear-gradient(180deg, #0f151b, #0b0f12 70%),
    radial-gradient(1200px 800px at 50% -300px, rgba(194,111,58,.08), transparent 60%);
  border-bottom:1px solid #0f1a22;
  box-shadow:0 6px 16px rgba(0,0,0,.35);
}
.controls{ display:flex; flex-wrap:wrap; gap:12px; align-items:center; }
.group{
  display:flex; align-items:center; gap:8px;
  padding-right:12px; margin-right:6px;
  border-right:1px solid #253340;
}
.group:last-child{ border-right:none; padding-right:0; }
.group-title{ color:#8aa0b3; font-size:12px; margin-right:2px; }

.controls label{ display:flex; gap:6px; align-items:center; color:var(--muted); }
.controls input[type=range]{ width:120px; }
.sep{ width:1px; height:22px; background:#253340; margin:0 4px; }

/* ---------- World / Canvas ---------- */
#worldWrap{
  display:flex; justify-content:center; align-items:center;
  padding:6px;
  margin-top: calc(var(--topbar-h) + 8px);
}
#world{
  width:100%; max-width:1200px; aspect-ratio:16/10;
  background:
    radial-gradient(1200px 600px at 50% 30%, rgba(0,0,0,.35), transparent 60%),
    radial-gradient(900px 500px at 10% 85%, rgba(194,111,58,.06), transparent 55%),
    radial-gradient(900px 500px at 90% 15%, rgba(39,199,255,.05), transparent 55%),
    linear-gradient(180deg, rgba(20,30,36,.9), rgba(12,16,20,.9)),
    /* faint grid */
    repeating-linear-gradient(0deg, transparent, transparent 30px, rgba(255,255,255,.03) 31px),
    repeating-linear-gradient(90deg, transparent, transparent 30px, rgba(255,255,255,.03) 31px);
  border:1px solid #17222c;
  border-radius:10px;
  display:block;
  box-shadow: inset 0 0 120px rgba(0,0,0,.35);
}

/* ---------- Panels: Einheitlich & zentriert ---------- */
.panel{
  position:fixed;
  left:50%;
  transform:translateX(-50%);
  top: calc(var(--topbar-h) + 16px);
  z-index:3000;

  width: min(820px, 96vw);
  max-height: calc(100vh - var(--topbar-h) - 32px);

  background:var(--panel);
  border:1px solid var(--line-1);
  border-radius:var(--radius);
  box-shadow: var(--shadow-2);
  display:flex; flex-direction:column;
  overflow:hidden;
}
.panel.hidden{ display:none; }

.panel-header{
  position:sticky; top:0; z-index:1;
  display:flex; align-items:center; justify-content:space-between;
  gap:12px; padding:12px 14px 10px 14px;
  background: linear-gradient(180deg, var(--panel-top), var(--panel));
  border-bottom:1px solid var(--line-1);
}
.panel-header h2{ margin:0; font-size:16px; letter-spacing:.2px; }
.closeX{
  width:28px; height:28px; display:grid; place-items:center;
  border-radius:8px; border:1px solid var(--line-2);
  color:var(--ink); background:#15222c; cursor:pointer;
  line-height:1; font-size:18px; padding:0;
}
.closeX:hover{ background:#1a2a35; }

.panel-body{
  overflow:auto;
  padding:12px;
  min-height:0;
}

/* ---------- CRISPR-Editor: 2 Spalten ---------- */
#editorPanel .panel-body{
  overflow:hidden;
  display:grid;
  grid-template-columns: 1fr 320px; /* links flexibel, rechts fix */
  gap:10px; min-height:0;
}
#editorPanel .editor-detail,
#editorPanel .editor-list{
  min-height:0; overflow:auto;
  border:1px solid var(--line-2);
  border-radius:8px; background:#0d1419;
}
#editorPanel .editor-list{ border-color:#253542; padding:0; }
#editorPanel .editor-list .list{ padding:8px; }
#editorPanel .editor-item.active{ outline:2px solid rgba(39,199,255,.35); background:#0f1720; }

/* Suche oben in der Liste */
#editorPanel .editor-list input[type=text]{
  width:100%; background:#0b1217; border:1px solid #2a3a46; color:var(--ink);
  border-radius:8px; padding:8px 10px;
}
#editorPanel .editor-list > div:first-child{ position:sticky; top:0; background:var(--panel); padding:8px; border-bottom:1px solid var(--line-1); }

/* Listenitems */
.cellItem{
  padding:8px; border:1px solid #253542; border-radius:8px; background:#0d1419;
}
.cellItem .name{ font-weight:600; }
.cellItem .meta{ color:#8fa2b5; font-size:12px; }

/* ---------- Error Overlay ---------- */
#errorOverlay{
  position:fixed; inset:0; z-index:4000;
  background:rgba(0,0,0,.55);
  display:none; align-items:center; justify-content:center;
}
#errorOverlay:not(.hidden){ display:flex; }
.errorCard{
  width:min(780px, 92vw);
  background: linear-gradient(180deg, #151b22, #12171d);
  border:1px solid #2f3d48; border-radius:12px; padding:16px;
  box-shadow: var(--shadow-1);
}
#errorText{ white-space:pre-wrap; color:#ffb3b3; }

/* ---------- Ticker ---------- */
#ticker{
  color:#9fb6c9; font-size:12px;
  display:flex; gap:12px; align-items:center; flex-wrap:wrap;
}

/* ---------- Scrollbar Styling ---------- */
*::-webkit-scrollbar{ width:10px; height:10px; }
*::-webkit-scrollbar-thumb{
  background: linear-gradient(180deg, #273640, #22303a);
  border:1px solid #2a3a46; border-radius:999px;
}
*::-webkit-scrollbar-thumb:hover{ background: linear-gradient(180deg, #2c3f4b, #263641); }
*::-webkit-scrollbar-track{ background: #0b1116; border-radius:999px; }

/* ---------- Tiny Utility Accents ---------- */
.highlight{
  color:var(--accent);
  text-shadow:0 0 10px rgba(46,229,106,.35);
}
.brand{
  color:var(--brand);
  text-shadow:0 0 12px rgba(39,199,255,.35);
}

/* ---------- Small Glow for Food (used by renderer rectangles) ---------- */
.food-glow{
  filter: drop-shadow(0 0 6px rgba(46,229,106,.45))
          drop-shadow(0 0 14px rgba(46,229,106,.25));
}

/* ---------- Backdrop for Panels (optional, attach via JS if needed) ---------- */
.backdrop{
  position:fixed; inset:0; z-index:2999;
  background: radial-gradient(1200px 800px at 50% 10%, rgba(0,0,0,.55), rgba(0,0,0,.75));
}

/* ---------- Responsive ---------- */
@media (max-width: 720px){
  .panel{ width:min(96vw, 640px); }
  #editorPanel .panel-body{
    grid-template-columns: 1fr;
    grid-auto-rows:minmax(160px, auto);
  }
  #editorPanel .editor-list{ order:1; }
  #editorPanel .editor-detail{ order:2; }
}

/* ---------- Theming the Topbar toggles ---------- */
label[title*="Performance"]{
  padding:2px 6px; border-radius:8px; border:1px solid var(--line-2);
  background:#121a21;
}
label[title*="Performance"] input{ margin-right:6px; }

/* ---------- Subtle rust accent line under topbar ---------- */
#topbar::after{
  content:""; position:absolute; left:0; right:0; bottom:-1px; height:2px;
  background:linear-gradient(90deg, transparent 0%, rgba(194,111,58,.35) 8%, rgba(39,199,255,.25) 35%, rgba(46,229,106,.25) 65%, transparent 100%);
  pointer-events:none;
}