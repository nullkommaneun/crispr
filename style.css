:root{
  --bg:#0f1220;
  --panel:#14182b;
  --ink:#e6e8f2;
  --ink-dim:#aab0c5;
  --accent:#6ae3ff;
  --accent-2:#ffc36a;
  --danger:#ff4d5a;
  --ok:#43d39e;
  --grid:#1c223d;
  --ticker-bg:#0b0f1c;
  --paper:#f8f4ea;
  --paper-ink:#1b1b1b;
  --shadow: 0 8px 24px rgba(0,0,0,.3);
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  color:var(--ink);
  background:linear-gradient(180deg,#0d1120 0%,#0b0f1c 100%);
  font: 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
  -webkit-font-smoothing:antialiased;
  text-rendering:optimizeLegibility;
}

.mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}

.hidden{display:none}

/* Fehlerbalken */
#errorOverlay{
  position:fixed; inset:auto 0 0 0; top:0;
  background:var(--danger);
  color:#fff; padding:.6rem 1rem;
  font-weight:600; z-index:9999;
  box-shadow:var(--shadow);
  display:none;
}
#errorOverlay.show{display:block}

/* Toolbar */
.toolbar{
  position:sticky; top:0; z-index:1000;
  background:rgba(12,15,30,.85);
  backdrop-filter:saturate(160%) blur(6px);
  padding:.5rem .75rem; border-bottom:1px solid #1d2442;
}
.toolbar-row{
  display:flex; flex-wrap:wrap; gap:.5rem; align-items:center;
}
.toolbar button,
.toolbar select, 
.toolbar input[type="range"]{
  appearance:none; -webkit-appearance:none;
  border:1px solid #273056; border-radius:.5rem;
  background:var(--panel); color:var(--ink);
  padding:.5rem .7rem; font-weight:600;
}
.toolbar button:hover{border-color:#3a4780}
.toolbar label{color:var(--ink-dim); margin:0 .2rem 0 .6rem}
.toolbar .status-badge{
  padding:.25rem .5rem; border-radius:.4rem; background:#1f2a4a; border:1px solid #2e3962;
}
.importLabel{
  border:1px dashed #37416f; border-radius:.5rem; padding:.4rem .6rem; cursor:pointer;
}
.importLabel input{display:none}

/* Canvas */
#main{
  display:grid; place-items:center;
  padding: .5rem .75rem;
}
#simCanvas{
  width: min(100vw - 1.5rem, 1200px);
  height: calc((min(100vw - 1.5rem, 1200px)) * 0.6);
  background:#080b16;
  border:1px solid #1c2242; border-radius:.75rem;
  box-shadow:var(--shadow);
  touch-action:none;
}

/* Narrative Panel */
#narrativeSection{
  margin:.75rem .75rem 4.5rem .75rem;
  background:var(--paper);
  color:var(--paper-ink);
  border-radius:.75rem;
  box-shadow:var(--shadow);
  overflow:hidden;
}
.paperHead{
  display:flex; justify-content:space-between; align-items:baseline;
  padding:.75rem 1rem .5rem;
  background:linear-gradient(180deg,#fff,#f4eee2);
  border-bottom:2px solid #e4dcc8;
}
.paperTitle{font:700 1.35rem/1 Georgia, "Times New Roman", Times, serif; letter-spacing:.02em}
.paperSub{color:#6b614f}
.scrollbox{
  max-height: 220px; overflow:auto; padding:.75rem 1rem;
}
.headline{
  font:700 1rem/1.25 Georgia, "Times New Roman", Times, serif;
  margin:.5rem 0; display:block;
}
.headline strong{font-weight:800}
.headline .src{font-weight:600; color:#555; margin-left:.35rem}

/* Ticker */
#ticker{
  position:fixed; left:0; right:0; bottom:0;
  background:var(--ticker-bg);
  border-top:1px solid #152042; color:var(--ink);
  padding:.15rem 0; z-index:1001;
}
#tickerInner{overflow:hidden; white-space:nowrap;}
#tickerContent{
  display:inline-block; padding-left:100%;
  animation: marquee 30s linear infinite;
  will-change:transform;
}
#tickerContent .tick{
  display:inline-block; margin:0 2rem; color:var(--ink-dim);
}
#tickerContent .tick .label{color:#6ae3ff; font-weight:700; margin-right:.25rem}
@keyframes marquee {
  0% { transform: translateX(0); }
  100% { transform: translateX(-100%); }
}

/* Modal (Editor) */
dialog#editorModal{
  width:min(100vw - 1.5rem, 980px);
  border:none; border-radius:.75rem;
  background:var(--panel); color:var(--ink);
  box-shadow:var(--shadow);
  padding:0; max-height:85vh;
}
.modalHeader{
  display:flex; align-items:center; justify-content:space-between;
  padding:.75rem 1rem; border-bottom:1px solid #28315f;
}
.modalBody{
  display:grid; grid-template-columns: 1fr 1fr; gap:1rem;
  padding:1rem; max-height:70vh; overflow:auto;
}
.editorLeft .traitRow{
  display:flex; align-items:center; justify-content:space-between;
  padding:.5rem 0; border-bottom:1px dotted #2f3968;
}
.stepper{display:flex; align-items:center; gap:.5rem}
.stepper button{
  width:2.5rem; height:2.5rem; font-weight:800; border-radius:.6rem;
}
.stepper .val{min-width:2ch; text-align:center}
.editorActions{ margin-top:1rem }
button.primary{ background: #1f2a4a; border-color:#3c4a7e }
.hint{color:var(--ink-dim)}

.editorRight .cellList{
  display:grid; gap:.35rem;
}
.cellCard{
  border:1px solid #2d3767; border-radius:.5rem; padding:.5rem .6rem; background:#121730;
  display:flex; align-items:baseline; justify-content:space-between;
}
.cellCard .id{font-weight:700}
.cellCard .score{font-variant-numeric: tabular-nums; color:var(--accent-2)}

.advisorBox{
  margin-top:1rem; padding:.5rem .6rem; background:#101631; border:1px solid #2d3767; border-radius:.5rem;
}

/* Touchgrößen */
button, select{ min-height: 40px }
input[type="range"]{ height: 32px }

/* Fokus sichtbar */
:focus-visible{ outline:2px solid var(--accent); outline-offset:2px }